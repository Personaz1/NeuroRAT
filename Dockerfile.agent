# Используем базовый образ Python
FROM python:3.11-slim

# Устанавливаем рабочую директорию
WORKDIR /app

# Устанавливаем зависимости (только dnspython нужен для этого модуля)
# Добавь другие зависимости сюда, если агент будет их использовать
RUN pip install dnspython

# Копируем всю директорию src, содержащую код агента и общие утилиты
COPY src/ ./src/

# Команда по умолчанию для запуска агента как модуля
# Переменные окружения для конфигурации (AGENT_C2_DOMAIN и т.д.)
# будут установлены в docker-compose.yml или оставлены по умолчанию
CMD ["python", "-u", "-m", "src.modules.dns_tunnel"]
# Флаг -u нужен для небуферизованного вывода, чтобы логи сразу появлялись в Docker 